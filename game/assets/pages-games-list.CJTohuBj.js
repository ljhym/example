import{_ as e,h as t,j as s,k as a,C as l,l as o,n as i,r,a as n,c,w as u,m as p,p as d,q as m,i as h,b as y,t as f,u as k,v as g,o as w,f as b,x as C,y as v,F as _}from"./index-EYZk6_JY.js";import{g as T}from"./games.Ds8COotu.js";const x=e({data:()=>({list:[],curTab:{},keyword:"",tabs:[{name:"闯关",type:"1"},{name:"对战",type:"2"},{name:"射击",type:"3"},{name:"休闲",type:"4"},{name:"RPG",type:"5"},{name:"合卡",type:"6"},{name:"改版",type:"7"},{name:"其他1",type:"8"},{name:"其他2",type:"9"}]}),computed:{showList(){return this.list.filter((e=>!!this.curTab.type&&e.type==this.curTab.type)).filter((e=>!this.keyword||(!!e.name.includes(this.keyword)||(!!e.name.includes(this.keyword.toUpperCase())||!!e.name.includes(this.keyword.toLowerCase())))))}},onLoad(){this.curTab=this.tabs[0];const e=t("games-list")||[];0===e.length?this.loadmore():this.list=e},methods:{clickRab(e){console.log(e),this.curTab=e},leftClick(){uni.webView.postMessage({data:{action:"back"}})},async check404(e){const t=[];for(let s=0;s<e.length;s+=50){const a=e.slice(s,s+50);await Promise.all(a.map((e=>fetch(e).then((s=>404===s.status&&t.push(e))).catch((()=>{})))))}return t},refresh(){console.log("refresh"),this.keyword="",this.list=[],this.loadmore()},scrolltolower(){},async loadmore(){var e;s({title:"加载中",mask:!0});let t=await T({code:"games-list"});a();JSON.parse(null==(e=t.data)?void 0:e.content).forEach((e=>{e.url?this.list.push({url:l.VITE_UPLOAD_BASE+e.url,type:e.type,name:this.trimNumberPrefix(e.url)}):console.log(e)})),o("games-list",this.list)},trimNumberPrefix(e){var t,s,a;let l=null==(a=null==(s=null==(t=null==e?void 0:e.split("/"))?void 0:t.pop())?void 0:s.slice(0,-4))?void 0:a.replace(/\s+/g,"").replace(/你妹汉化版/gi,"").replace(/你妹汉化组/gi,"").replace(/你妹联合/gi,""),o=/^\d+\./.test(l)?l.replace(/^\d+\./,""):l;return o=/^\d+\-/.test(o)?o.replace(/^\d+\-/,""):o,o},play(e){o("games-info",e),i({url:"/pages/games/games"})}}},[["render",function(e,t,s,a,l,o){const i=r(n("up-navbar"),p),T=r(n("up-search"),d),x=r(n("u-tabs"),m),L=h,P=r(n("up-cell"),y),V=r(n("up-list-item"),f),S=r(n("u-loadmore"),k),j=r(n("up-list"),g);return w(),c(L,{class:"pages"},{default:u((()=>[b(L,null,{default:u((()=>[b(i,{title:"游戏列表",placeholder:"",onLeftClick:o.leftClick,safeAreaInsetTop:!0,autoBack:!1},null,8,["onLeftClick"]),b(T,{placeholder:"搜索游戏",shape:"square",modelValue:l.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>l.keyword=e),actionText:"刷新",onCustom:o.refresh},null,8,["modelValue","onCustom"]),b(x,{list:l.tabs,onClick:o.clickRab},null,8,["list","onClick"])])),_:1}),b(L,{style:{flex:"1",overflow:"hidden"}},{default:u((()=>[b(j,{style:{height:"100%"},onScrolltolower:o.scrolltolower},{default:u((()=>[(w(!0),C(_,null,v(o.showList,((e,t)=>(w(),c(V,{key:t},{default:u((()=>[b(P,{title:`${t+1}、`+e.name,onClick:t=>o.play(e)},null,8,["title","onClick"])])),_:2},1024)))),128)),b(S,{status:"nomore"})])),_:1},8,["onScrolltolower"])])),_:1})])),_:1})}],["__scopeId","data-v-81507306"]]);export{x as default};
