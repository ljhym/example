import{n as T,o as V,c as X,w as q,T as Y,p as G,d as U,a as w,z}from"./vendor.d2fb6949.js";import{aw as J,V as y,E as Q,p as R,P as Z,S as $,ax as ee,aq as te,ay as oe,az as j,t as ne,a4 as F,ap as re,aA as ie,l as se}from"./three.module.99621659.js";import{_ as ae}from"./index.ef2301ac.js";const k=new J(0,0,0,"YXZ"),x=new y,ce={type:"change"},le={type:"lock"},de={type:"unlock"},H=Math.PI/2;class me extends Q{constructor(n,a){super();a===void 0&&(console.warn('THREE.PointerLockControls: The second parameter "domElement" is now mandatory.'),a=document.body),this.domElement=a,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1;const e=this;function i(t){if(e.isLocked===!1)return;const l=t.movementX||t.mozMovementX||t.webkitMovementX||0,v=t.movementY||t.mozMovementY||t.webkitMovementY||0;k.setFromQuaternion(n.quaternion),k.y-=l*.002*e.pointerSpeed,k.x-=v*.002*e.pointerSpeed,k.x=Math.max(H-e.maxPolarAngle,Math.min(H-e.minPolarAngle,k.x)),n.quaternion.setFromEuler(k),e.dispatchEvent(ce)}function g(){e.domElement.ownerDocument.pointerLockElement===e.domElement?(e.dispatchEvent(le),e.isLocked=!0):(e.dispatchEvent(de),e.isLocked=!1)}function u(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){e.domElement.ownerDocument.addEventListener("mousemove",i),e.domElement.ownerDocument.addEventListener("pointerlockchange",g),e.domElement.ownerDocument.addEventListener("pointerlockerror",u)},this.disconnect=function(){e.domElement.ownerDocument.removeEventListener("mousemove",i),e.domElement.ownerDocument.removeEventListener("pointerlockchange",g),e.domElement.ownerDocument.removeEventListener("pointerlockerror",u)},this.dispose=function(){this.disconnect()},this.getObject=function(){return n},this.getDirection=function(){const t=new y(0,0,-1);return function(l){return l.copy(t).applyQuaternion(n.quaternion)}}(),this.moveForward=function(t){x.setFromMatrixColumn(n.matrix,0),x.crossVectors(n.up,x),n.position.addScaledVector(x,t)},this.moveRight=function(t){x.setFromMatrixColumn(n.matrix,0),n.position.addScaledVector(x,t)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){e.domElement.ownerDocument.exitPointerLock()},this.connect()}}const ue=b=>(G("data-v-22eaa37f"),b=b(),U(),b),pe=ue(()=>w("div",{id:"playgame"},[w("div",{id:"blocker"},[w("div",{id:"instructions"},[w("p",{style:{"font-size":"36px"}},"Click to play"),w("p",null,[z(" Move: WASD "),w("br"),z("Jump: SPACE "),w("br"),z("Look: MOUSE ")])])])],-1)),fe={__name:"playgame",setup(b){let n,a,e,i;const g=[];let u,t=!1,l=!1,v=!1,L=!1,_=!1,D=performance.now();const s=new y,E=new y,p=new y,d=new R;let P;function K(){n=new Z(75,window.innerWidth/window.innerHeight,1,1e3),n.position.y=10,a=new $,a.background=new R(16777215);const c=new ee(15658751,7829384,.75);c.position.set(.5,1,.75),a.add(c),i=new me(n,P);const f=function(o){switch(o.code){case"ArrowUp":case"KeyW":t=!0;break;case"ArrowLeft":case"KeyA":v=!0;break;case"ArrowDown":case"KeyS":l=!0;break;case"ArrowRight":case"KeyD":L=!0;break;case"Space":_===!0&&(s.y+=350),_=!1;break}},A=function(o){switch(o.code){case"ArrowUp":case"KeyW":t=!1;break;case"ArrowLeft":case"KeyA":v=!1;break;case"ArrowDown":case"KeyS":l=!1;break;case"ArrowRight":case"KeyD":L=!1;break}};document.addEventListener("keydown",f),document.addEventListener("keyup",A),u=new te(new y,new y(0,-1,0),0,10);let r=new oe(2e3,2e3,100,100);r.rotateX(-Math.PI/2);let h=r.attributes.position;for(let o=0,m=h.count;o<m;o++)p.fromBufferAttribute(h,o),p.x+=Math.random()*20-10,p.y+=Math.random()*2,p.z+=Math.random()*20-10,h.setXYZ(o,p.x,p.y,p.z);r=r.toNonIndexed(),h=r.attributes.position;const I=[];for(let o=0,m=h.count;o<m;o++)d.setHSL(Math.random()*.3+.5,.75,Math.random()*.25+.75),I.push(d.r,d.g,d.b);r.setAttribute("color",new j(I,3));const W=new ne({vertexColors:!0}),N=new F(r,W);a.add(N);const S=new re(20,20,20).toNonIndexed();h=S.attributes.position;const B=[];for(let o=0,m=h.count;o<m;o++)d.setHSL(Math.random()*.3+.5,.75,Math.random()*.25+.75),B.push(d.r,d.g,d.b);S.setAttribute("color",new j(B,3));for(let o=0;o<500;o++){const m=new ie({specular:16777215,flatShading:!0,vertexColors:!0});m.color.setHSL(Math.random()*.2+.5,.75,Math.random()*.25+.75);const M=new F(S,m);M.position.x=Math.floor(Math.random()*20-10)*20,M.position.y=Math.floor(Math.random()*20)*20+10,M.position.z=Math.floor(Math.random()*20-10)*20,a.add(M),g.push(M)}e=new se({antialias:!0}),e.setPixelRatio(window.devicePixelRatio),e.setSize(window.innerWidth,window.innerHeight),P.appendChild(e.domElement),window.addEventListener("resize",O)}T(()=>{const c=document.getElementById("blocker"),f=document.getElementById("instructions");P=document.getElementById("playgame"),K(),C(),f.addEventListener("click",function(){i.lock()}),i.addEventListener("lock",function(){f.style.display="none",c.style.display="none"}),i.addEventListener("unlock",function(){c.style.display="block",f.style.display=""}),a.add(i.getObject())});function O(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),e.setSize(window.innerWidth,window.innerHeight)}function C(){requestAnimationFrame(C);const c=performance.now();if(i.isLocked===!0){u.ray.origin.copy(i.getObject().position),u.ray.origin.y-=10;const A=u.intersectObjects(g,!1).length>0,r=(c-D)/1e3;s.x-=s.x*10*r,s.z-=s.z*10*r,s.y-=9.8*100*r,E.z=Number(t)-Number(l),E.x=Number(L)-Number(v),E.normalize(),(t||l)&&(s.z-=E.z*400*r),(v||L)&&(s.x-=E.x*400*r),A===!0&&(s.y=Math.max(0,s.y),_=!0),i.moveRight(-s.x*r),i.moveForward(-s.z*r),i.getObject().position.y+=s.y*r,i.getObject().position.y<10&&(s.y=0,i.getObject().position.y=10,_=!0)}D=c,e.render(a,n)}return(c,f)=>(V(),X(Y,{name:"fade"},{default:q(()=>[pe]),_:1}))}};var ve=ae(fe,[["__scopeId","data-v-22eaa37f"]]);export{ve as default};
