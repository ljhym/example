import{_ as B,e as M,h as S,o as s,c as r,n as E,i as a,F as l,j as g,b as p,q as _,l as P,t as T,p as V,m as D}from"./index.53ca4913.js";const w=d=>(V("data-v-bfd1e01e"),d=d(),D(),d),W={class:"mypage"},$=["width","height","viewBox"],N=["patternTransform","id","width","height"],z=["xlink:href","width","height"],F=["id"],O=["width","height","mask"],q=["id"],A=["width","height"],H=["xlink:href","width","height"],G=["xlink:href","width","height"],J=["width","height","href","fill"],K=["xlink:href","width","height"],Q=w(()=>a("br",null,null,-1)),Z=["onClick"],ee=w(()=>a("br",null,null,-1)),te=["value"],ie=w(()=>a("br",null,null,-1)),ne=["value"],ae=w(()=>a("br",null,null,-1)),oe={__name:"svg2",setup(d){const e=M({scale:1,rotate:0,showbili:4,selindex:0,baseimg:"",buweiarr:[],svgwidth:500,svgheight:750,showwidth:500,showheight:750});let m=e.svgwidth/window.innerWidth;e.svgwidth=window.innerWidth,e.showwidth=window.innerWidth,e.svgheight*=m,e.showheight*=m,window.innerWidth<600&&(e.showbili=6);let c,b,x;function f(i){x=!0,c=i.pageX,b=i.pageY}function j(i){if(!x)return;let o=i.pageX-c,t=i.pageY-b,n=Math.PI/180*e.buweiarr[e.selindex].textureobj.rotate;t!=0&&(e.buweiarr[e.selindex].textureobj.transtitonX+=t*e.showbili*Math.sin(n),e.buweiarr[e.selindex].textureobj.transtitonY+=t*e.showbili*Math.cos(n)),o!=0&&(e.buweiarr[e.selindex].textureobj.transtitonX+=o*e.showbili*Math.cos(n),e.buweiarr[e.selindex].textureobj.transtitonY+=-o*e.showbili*Math.sin(n)),c=i.pageX,b=i.pageY}function y(i){x=!1}function k(){e.buweiarr[e.selindex].textureobj.transtitonX+=40}function C(){e.buweiarr[e.selindex].textureobj.transtitonY+=40}function U(){let i=document.getElementById("paper");var o=i.outerHTML,t=new Image;t.src="data:image/svg+xml;base64,"+window.btoa(unescape(encodeURIComponent(o))),t.onload=function(){var n=document.createElement("canvas");n.width=i.width.animVal.value,n.height=i.height.animVal.value;var u=n.getContext("2d");u.drawImage(t,0,0);var h=document.createElement("a");h.href=n.toDataURL("image/png"),h.download="\u6548\u679C\u56FE",h.click()}}function I(i){console.log(i.target.value),e.buweiarr[e.selindex].textureobj.scale=i.target.value,e.scale=i.target.value}function L(i){console.log(i.target.value),e.buweiarr[e.selindex].textureobj.rotate=i.target.value,e.rotate=i.target.value}function v(i){return new Promise((o,t)=>{let n=new Image;n.setAttribute("crossOrigin","anonymous");let u=i;n.src=u,n.onload=()=>{var h=document.createElement("canvas");h.width=n.width,h.height=n.height;var X=h.getContext("2d");X.drawImage(n,0,0,n.width,n.height);var R=h.toDataURL("image/jpeg"),Y=h.toDataURL("image/png");o({base64:R,pngdataURL:Y,width:n.width,height:n.height,transtitonX:0,transtitonY:0,rotate:30,scale:1})},n.onerror=()=>{t(!1)}})}return S(async()=>{let i={baseimg:"./images/svgtest/bai1.jpg",buweiarr:[{title:"\u6574\u4F53",image:"./images/svgtest/bai2.png",component_id:1,texture:"./images/svgtest/yundong1.png"},{title:"\u524D\u5E45",image:"./images/svgtest/bai3.png",component_id:2,texture:"./images/svgtest/05.jpg"}]},o=await v(i.baseimg);e.svgwidth=o.width,e.svgheight=o.height,e.baseimg=o.base64,e.showwidth=o.width/e.showbili,e.showheight=o.height/e.showbili;for(let t=0;t<i.buweiarr.length;t++){console.log(t);let n=await v(i.buweiarr[t].image);i.buweiarr[t].img=n,i.buweiarr[t].texture&&(i.buweiarr[t].textureobj=await v(i.buweiarr[t].texture))}e.buweiarr=i.buweiarr,console.log(e.buweiarr)}),(i,o)=>(s(),r("div",W,[(s(),r("svg",{id:"paper",onPointerdown:f,onPointermove:j,onPointerup:y,style:E({height:e.showheight+"px",width:e.showwidth+"px"}),width:e.svgwidth+"px",height:e.svgheight+"px",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 "+e.svgwidth+" "+e.svgheight},[a("defs",null,[(s(!0),r(l,null,g(e.buweiarr,(t,n)=>(s(),r(l,null,[t.textureobj?(s(),r("pattern",{key:0,patternTransform:`rotate(${t.textureobj.rotate}) translate(${t.textureobj.transtitonX},${t.textureobj.transtitonY})`,id:"texture"+t.component_id,x:"0",y:"0",width:t.textureobj.width*t.textureobj.scale,height:t.textureobj.height*t.textureobj.scale,patternUnits:"userSpaceOnUse"},[a("image",{"xlink:href":t.textureobj.base64,x:"0",y:"0",width:t.textureobj.width*t.textureobj.scale,height:t.textureobj.height*t.textureobj.scale},null,8,z)],8,N)):_("",!0)],64))),256)),(s(!0),r(l,null,g(e.buweiarr,(t,n)=>(s(),r("symbol",{id:"path"+t.component_id},[a("rect",{x:"0",y:"0",width:e.svgwidth,height:e.svgheight,mask:"url(#small-rect"+t.component_id+")"},null,8,O)],8,F))),256)),(s(!0),r(l,null,g(e.buweiarr,(t,n)=>(s(),r("mask",{id:"small-rect"+t.component_id},[a("rect",{x:"0",y:"0",width:e.svgwidth,height:e.svgheight,fill:"#fff"},null,8,A),a("image",{"xlink:href":t.img.base64,x:"0",y:"0",width:e.svgwidth,height:e.svgheight},null,8,H)],8,q))),256))]),(s(!0),r(l,null,g(e.buweiarr,(t,n)=>(s(),r(l,null,[t.textureobj?(s(),r("image",{key:0,"xlink:href":t.img.pngdataURL,x:"0",y:"0",width:e.svgwidth,height:e.svgheight},null,8,G)):_("",!0),a("use",{x:"0",y:"0",width:e.svgwidth,height:e.svgheight,href:"#path"+t.component_id,fill:"url('#texture"+t.component_id+"')"},null,8,J)],64))),256)),a("image",{"xlink:href":e.baseimg,x:"0",y:"0",width:e.svgwidth,height:e.svgheight,style:{"mix-blend-mode":"multiply"}},null,8,K)],44,$)),Q,(s(!0),r(l,null,g(e.buweiarr,(t,n)=>(s(),r("span",{class:P(["buwei",[e.selindex==n?"actbuwei":""]]),onClick:u=>e.selindex=n},T(t.title),11,Z))),256)),ee,p(" \u7F29\u653E\uFF1A "),a("input",{type:"range",onChange:I,step:"0.1",value:e.scale,max:"10",min:"0.1"},null,40,te),ie,p(" \u65CB\u8F6C\uFF1A "),a("input",{type:"range",onChange:L,value:e.rotate,max:"360",min:"0"},null,40,ne),ae,a("button",{onClick:k},"x+10"),a("button",{onClick:C},"y+10"),a("button",{onClick:U},"\u4E0B\u8F7D\u56FE\u7247")]))}},re=B(oe,[["__scopeId","data-v-bfd1e01e"]]);export{re as default};
